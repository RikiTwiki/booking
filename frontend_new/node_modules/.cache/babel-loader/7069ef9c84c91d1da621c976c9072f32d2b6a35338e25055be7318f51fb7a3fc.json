{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/web.dom-exception.stack.js\";\nimport axios from 'axios';\nexport default {\n  data() {\n    return {\n      users: [],\n      showModal: false,\n      isEditing: false,\n      formData: {\n        id: null,\n        email: '',\n        password: '',\n        role: 'user'\n      }\n    };\n  },\n  async created() {\n    try {\n      const token = localStorage.getItem('authToken');\n      if (!token) {\n        this.$router.push('/login'); // Перенаправить на страницу логина, если токена нет\n        return;\n      }\n      const decodedToken = JSON.parse(atob(token.split('.')[1])); // Расшифровать JWT токен\n      this.isAdmin = decodedToken.role === 'admin';\n      if (!this.isAdmin) {\n        this.$router.push('/'); // Перенаправить, если пользователь не администратор\n      }\n    } catch (error) {\n      console.error('Error decoding token:', error);\n      this.$router.push('/login'); // Перенаправить в случае ошибки\n    }\n  },\n  methods: {\n    async fetchUsers() {\n      const token = localStorage.getItem('authToken');\n      const response = await axios.get('/users', {\n        // Исправлено на /api/users\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      this.users = response.data;\n    },\n    openCreateModal() {\n      this.showModal = true;\n      this.isEditing = false;\n      this.formData = {\n        id: null,\n        email: '',\n        password: '',\n        role: 'user'\n      };\n    },\n    openEditModal(user) {\n      this.showModal = true;\n      this.isEditing = true;\n      this.formData = {\n        id: user.id,\n        email: user.email,\n        role: user.role\n      };\n    },\n    async createUser() {\n      const token = localStorage.getItem('authToken');\n      await axios.post('/api/users', this.formData, {\n        // Исправлено на /api/users\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      this.closeModal();\n      await this.fetchUsers();\n    },\n    async updateUser() {\n      const token = localStorage.getItem('authToken');\n      await axios.put(`/api/users/${this.formData.id}`, this.formData, {\n        // Исправлено на /api/users\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      this.closeModal();\n      await this.fetchUsers();\n    },\n    async deleteUser(id) {\n      const token = localStorage.getItem('authToken');\n      await axios.delete(`/api/users/${id}`, {\n        // Исправлено на /api/users\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      await this.fetchUsers();\n    },\n    closeModal() {\n      this.showModal = false;\n    }\n  }\n};","map":{"version":3,"names":["axios","data","users","showModal","isEditing","formData","id","email","password","role","created","token","localStorage","getItem","$router","push","decodedToken","JSON","parse","atob","split","isAdmin","error","console","methods","fetchUsers","response","get","headers","Authorization","openCreateModal","openEditModal","user","createUser","post","closeModal","updateUser","put","deleteUser","delete"],"sources":["/home/rikitwiki/Desktop/booking-app/frontend/src/components/UsersPage.vue"],"sourcesContent":["<template>\n    <div>\n      <h1>Manage Users</h1>\n      <button @click=\"openCreateModal\">Create User</button>\n      <table>\n        <thead>\n          <tr>\n            <th>ID</th>\n            <th>Email</th>\n            <th>Role</th>\n            <th>Actions</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr v-for=\"user in users\" :key=\"user.id\">\n            <td>{{ user.id }}</td>\n            <td>{{ user.email }}</td>\n            <td>{{ user.role }}</td>\n            <td>\n              <button @click=\"openEditModal(user)\">Edit</button>\n              <button @click=\"deleteUser(user.id)\">Delete</button>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n  \n      <!-- Модальное окно создания и редактирования -->\n      <div v-if=\"showModal\" class=\"modal\">\n        <h2>{{ isEditing ? 'Edit User' : 'Create User' }}</h2>\n        <form @submit.prevent=\"isEditing ? updateUser() : createUser()\">\n          <input v-model=\"formData.email\" placeholder=\"Email\" required />\n          <input v-model=\"formData.password\" placeholder=\"Password\" :required=\"!isEditing\" />\n          <select v-model=\"formData.role\" required>\n            <option value=\"admin\">Admin</option>\n            <option value=\"user\">User</option>\n          </select>\n          <button type=\"submit\">{{ isEditing ? 'Save Changes' : 'Create User' }}</button>\n        </form>\n        <button @click=\"closeModal\">Cancel</button>\n      </div>\n    </div>\n  </template>\n  \n  <script>\n  import axios from 'axios';\n  \n  export default {\n    data() {\n      return {\n        users: [],\n        showModal: false,\n        isEditing: false,\n        formData: { id: null, email: '', password: '', role: 'user' },\n      };\n    },\n    async created() {\n        try {\n            const token = localStorage.getItem('authToken');\n            if (!token) {\n            this.$router.push('/login'); // Перенаправить на страницу логина, если токена нет\n            return;\n            }\n    \n            const decodedToken = JSON.parse(atob(token.split('.')[1])); // Расшифровать JWT токен\n            this.isAdmin = decodedToken.role === 'admin';\n    \n            if (!this.isAdmin) {\n            this.$router.push('/'); // Перенаправить, если пользователь не администратор\n            }\n        } catch (error) {\n            console.error('Error decoding token:', error);\n            this.$router.push('/login'); // Перенаправить в случае ошибки\n        }\n    },\n    methods: {\n        async fetchUsers() {\n            const token = localStorage.getItem('authToken');\n            const response = await axios.get('/users', {  // Исправлено на /api/users\n            headers: { Authorization: `Bearer ${token}` },\n            });\n            this.users = response.data;\n        },\n        openCreateModal() {\n            this.showModal = true;\n            this.isEditing = false;\n            this.formData = { id: null, email: '', password: '', role: 'user' };\n        },\n        openEditModal(user) {\n            this.showModal = true;\n            this.isEditing = true;\n            this.formData = { id: user.id, email: user.email, role: user.role };\n        },\n        async createUser() {\n            const token = localStorage.getItem('authToken');\n            await axios.post('/api/users', this.formData, {  // Исправлено на /api/users\n            headers: { Authorization: `Bearer ${token}` },\n            });\n            this.closeModal();\n            await this.fetchUsers();\n        },\n        async updateUser() {\n            const token = localStorage.getItem('authToken');\n            await axios.put(`/api/users/${this.formData.id}`, this.formData, {  // Исправлено на /api/users\n            headers: { Authorization: `Bearer ${token}` },\n            });\n            this.closeModal();\n            await this.fetchUsers();\n        },\n        async deleteUser(id) {\n            const token = localStorage.getItem('authToken');\n            await axios.delete(`/api/users/${id}`, {  // Исправлено на /api/users\n            headers: { Authorization: `Bearer ${token}` },\n            });\n            await this.fetchUsers();\n        },\n        closeModal() {\n            this.showModal = false;\n        },\n      }\n  };\n  </script>\n  \n  <style scoped>\n  /* Стили для таблицы и модальных окон */\n  </style>  "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}